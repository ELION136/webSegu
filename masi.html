<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ruleta de Seguridad Industrial</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            text-align: center;
            max-width: 800px;
            width: 100%;
        }

        h1 {
            color: white;
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .subtitle {
            color: #fff;
            font-size: 1.2rem;
            margin-bottom: 30px;
            opacity: 0.9;
        }

        .wheel-container {
            position: relative;
            width: 500px;
            height: 500px;
            margin: 0 auto 40px;
            max-width: 90vw;
            max-height: 90vw;
        }

        .wheel-wrapper {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            position: relative;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            transition: transform 4s cubic-bezier(0.25, 0.1, 0.25, 1);
            border: 15px solid white;
            overflow: hidden;
        }

        #wheelCanvas {
            width: 100%;
            height: 100%;
            border-radius: 50%;
        }

        .wheel-center {
            position: absolute;
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            border: 5px solid white;
        }

        .wheel-center::after {
            content: 'üéØ';
            font-size: 2rem;
        }

        .arrow {
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 25px solid transparent;
            border-right: 25px solid transparent;
            border-top: 50px solid #ff4757;
            z-index: 20;
            filter: drop-shadow(0 3px 6px rgba(0,0,0,0.3));
        }

        .arrow::before {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            background: #ff4757;
            border-radius: 50%;
            top: -60px;
            left: 50%;
            transform: translateX(-50%);
        }

        .spin-button {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            color: white;
            border: none;
            padding: 20px 60px;
            font-size: 1.5rem;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            transition: all 0.3s;
            text-transform: uppercase;
        }

        .spin-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.4);
        }

        .spin-button:active {
            transform: translateY(-1px);
        }

        .spin-button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 20px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            animation: modalSlideIn 0.3s ease-out;
            position: relative;
        }

        @keyframes modalSlideIn {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-header {
            font-size: 1.8rem;
            color: #667eea;
            margin-bottom: 20px;
            font-weight: bold;
        }

        .modal-body {
            font-size: 1.2rem;
            color: #333;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .timer {
            font-size: 2rem;
            color: #ff4757;
            font-weight: bold;
            margin: 20px 0;
        }

        .answer-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .answer-btn {
            padding: 15px 30px;
            font-size: 1.1rem;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            background: #667eea;
            color: white;
        }

        .answer-btn:hover {
            transform: translateY(-2px);
            background: #5568d3;
        }

        .close-btn {
            background: #667eea;
            color: white;
            padding: 15px 40px;
            font-size: 1.1rem;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }

        .close-btn:hover {
            background: #5568d3;
            transform: translateY(-2px);
        }

        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: #f0f;
            position: absolute;
            animation: confetti-fall 3s linear;
        }

        @keyframes confetti-fall {
            to {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        .result-message {
            font-size: 1.3rem;
            margin-top: 20px;
            padding: 15px;
            border-radius: 10px;
            font-weight: bold;
        }

        .result-message.success {
            background: #26de81;
            color: white;
        }

        .result-message.fail {
            background: #ff6b6b;
            color: white;
        }

        @media (max-width: 600px) {
            h1 {
                font-size: 1.8rem;
            }
            
            .wheel-container {
                width: 350px;
                height: 350px;
            }

            .spin-button {
                padding: 15px 40px;
                font-size: 1.2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üè≠ Ruleta de Seguridad Industrial üè≠</h1>
        <p class="subtitle">Iluminaci√≥n y Ventilaci√≥n</p>
        
        <div class="wheel-container">
            <div class="arrow"></div>
            <div class="wheel-wrapper" id="wheelWrapper">
                <canvas id="wheelCanvas"></canvas>
            </div>
            <div class="wheel-center"></div>
        </div>

        <button class="spin-button" id="spinButton">¬°GIRAR!</button>
    </div>

    <div class="modal" id="modal">
        <div class="modal-content">
            <div class="modal-header" id="modalHeader"></div>
            <div class="modal-body" id="modalBody"></div>
            <div id="modalActions"></div>
        </div>
    </div>

    <script>
        const segments = [
            {
                type: 'pregunta',
                text: '¬øQu√© es\ndeslumbramiento?',
                question: '¬øQu√© es deslumbramiento?',
                answers: ['Exceso de luz que molesta la visi√≥n', 'Falta de luz', 'Luz tenue', 'Iluminaci√≥n perfecta'],
                correct: 0,
                color: '#FF6B6B'
            },
            {
                type: 'castigo',
                text: 'Castigo\nüòÖ',
                action: 'Haz 10 saltos como si evitaras un deslumbramiento',
                color: '#4ECDC4'
            },
            {
                type: 'pregunta',
                text: '¬øLux en\noficinas?',
                question: '¬øCu√°ntos lux se recomiendan para oficinas?',
                answers: ['100 lux', '300 lux', '500 lux', '1000 lux'],
                correct: 2,
                color: '#FFE66D'
            },
            {
                type: 'frase',
                text: 'Ni modo\nü§∑‚Äç‚ôÇÔ∏è',
                message: 'Ni modo... a la pr√≥xima ser√° üòÖ',
                color: '#95E1D3'
            },
            {
                type: 'pregunta',
                text: 'Riesgos\nventilaci√≥n',
                question: '¬øQu√© riesgos causa la mala ventilaci√≥n?',
                answers: ['Dolor de cabeza y fatiga', 'Mejor concentraci√≥n', 'M√°s energ√≠a', 'Nada'],
                correct: 0,
                color: '#F38181'
            },
            {
                type: 'castigo',
                text: 'Castigo\n‚ö†Ô∏è',
                action: 'Camina como si estuvieras en un pasillo con mala iluminaci√≥n',
                color: '#AA96DA'
            },
            {
                type: 'pregunta',
                text: 'Iluminaci√≥n\nnatural',
                question: '¬øQu√© es la iluminaci√≥n natural?',
                answers: ['Luz artificial', 'Luz del sol', 'Luz LED', 'Luz de velas'],
                correct: 1,
                color: '#FCBAD3'
            },
            {
                type: 'frase',
                text: 'Fallaste\nüòî',
                message: 'Intentaste, pero fallaste ü§∑‚Äç‚ôÇÔ∏è',
                color: '#A8D8EA'
            },
            {
                type: 'premio',
                text: 'GRAN\nPREMIO\nüèÜ',
                message: '¬°Felicidades! Eres el campe√≥n de Seguridad Industrial üéâ',
                color: '#FFD93D'
            },
            {
                type: 'castigo',
                text: 'Castigo\nüí™',
                action: 'Simula ajustar una luminaria con las manos arriba por 5 segundos',
                color: '#6BCB77'
            }
        ];

        const canvas = document.getElementById('wheelCanvas');
        const ctx = canvas.getContext('2d');
        const wheelWrapper = document.getElementById('wheelWrapper');
        const spinButton = document.getElementById('spinButton');
        const modal = document.getElementById('modal');
        const modalHeader = document.getElementById('modalHeader');
        const modalBody = document.getElementById('modalBody');
        const modalActions = document.getElementById('modalActions');

        let isSpinning = false;
        let currentRotation = 0;

        // Configurar canvas
        function setupCanvas() {
            const size = canvas.offsetWidth;
            canvas.width = size;
            canvas.height = size;
            drawWheel();
        }

        // Dibujar ruleta completa
        function drawWheel() {
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const radius = canvas.width / 2;
            const anglePerSlice = (2 * Math.PI) / segments.length;

            segments.forEach((segment, index) => {
                const startAngle = anglePerSlice * index - Math.PI / 2;
                const endAngle = startAngle + anglePerSlice;

                // Dibujar segmento
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.arc(centerX, centerY, radius, startAngle, endAngle);
                ctx.closePath();
                ctx.fillStyle = segment.color;
                ctx.fill();

                // Borde entre segmentos
                ctx.strokeStyle = 'white';
                ctx.lineWidth = 3;
                ctx.stroke();

                // Dibujar texto
                ctx.save();
                ctx.translate(centerX, centerY);
                ctx.rotate(startAngle + anglePerSlice / 2);
                ctx.textAlign = 'center';
                ctx.fillStyle = 'white';
                ctx.font = 'bold 16px Arial';
                ctx.shadowColor = 'rgba(0,0,0,0.5)';
                ctx.shadowBlur = 4;
                ctx.shadowOffsetX = 2;
                ctx.shadowOffsetY = 2;

                // Texto en m√∫ltiples l√≠neas
                const lines = segment.text.split('\n');
                const lineHeight = 20;
                const textRadius = radius * 0.65;
                const startY = -(lines.length - 1) * lineHeight / 2;

                lines.forEach((line, i) => {
                    ctx.fillText(line, textRadius, startY + (i * lineHeight));
                });

                ctx.restore();
            });
        }

        // Sonidos
        function playSpinSound() {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.value = 200;
            oscillator.type = 'sine';
            
            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.5);
        }

        function playWinSound() {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.setValueAtTime(523.25, audioContext.currentTime);
            oscillator.frequency.setValueAtTime(659.25, audioContext.currentTime + 0.1);
            oscillator.frequency.setValueAtTime(783.99, audioContext.currentTime + 0.2);
            
            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.5);
        }

        // Crear confeti
        function createConfetti() {
            const colors = ['#ff6b6b', '#4ecdc4', '#ffe66d', '#95e1d3', '#f38181'];
            
            for (let i = 0; i < 100; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + '%';
                    confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.width = Math.random() * 10 + 5 + 'px';
                    confetti.style.height = confetti.style.width;
                    document.body.appendChild(confetti);
                    
                    setTimeout(() => confetti.remove(), 3000);
                }, i * 30);
            }
        }

        // Girar ruleta
        function spinWheel() {
            if (isSpinning) return;
            
            isSpinning = true;
            spinButton.disabled = true;
            playSpinSound();
            
            const spins = 5 + Math.random() * 3;
            const randomAngle = Math.random() * 360;
            const totalRotation = spins * 360 + randomAngle;
            
            currentRotation += totalRotation;
            wheelWrapper.style.transform = `rotate(${currentRotation}deg)`;
            
            setTimeout(() => {
                const normalizedAngle = currentRotation % 360;
                const anglePerSlice = 360 / segments.length;
                const selectedIndex = Math.floor((360 - normalizedAngle + anglePerSlice / 2) / anglePerSlice) % segments.length;
                
                showResult(segments[selectedIndex]);
                isSpinning = false;
                spinButton.disabled = false;
            }, 4000);
        }

        // Mostrar resultado
        function showResult(segment) {
            modalHeader.textContent = segment.text.replace(/\n/g, ' ');
            modal.classList.add('active');
            
            if (segment.type === 'pregunta') {
                showQuestion(segment);
            } else if (segment.type === 'castigo') {
                showCastigo(segment);
            } else if (segment.type === 'frase') {
                showFrase(segment);
            } else if (segment.type === 'premio') {
                showPremio(segment);
            }
        }

        // Mostrar pregunta
        function showQuestion(segment) {
            let timeLeft = 15;
            modalBody.innerHTML = `
                <div>${segment.question}</div>
                <div class="timer" id="timer">‚è±Ô∏è ${timeLeft}s</div>
            `;
            
            const timer = setInterval(() => {
                timeLeft--;
                document.getElementById('timer').textContent = `‚è±Ô∏è ${timeLeft}s`;
                
                if (timeLeft <= 0) {
                    clearInterval(timer);
                    showResult({type: 'frase', text: 'Tiempo agotado', message: '‚è∞ ¬°Se acab√≥ el tiempo!'});
                }
            }, 1000);
            
            modalActions.innerHTML = '';
            segment.answers.forEach((answer, index) => {
                const btn = document.createElement('button');
                btn.className = 'answer-btn';
                btn.textContent = answer;
                btn.onclick = () => {
                    clearInterval(timer);
                    checkAnswer(index, segment.correct);
                };
                modalActions.appendChild(btn);
            });
        }

        // Verificar respuesta
        function checkAnswer(selected, correct) {
            if (selected === correct) {
                playWinSound();
                modalBody.innerHTML = '<div class="result-message success">üéâ ¬°CORRECTO! ¬°Excelente conocimiento!</div>';
            } else {
                modalBody.innerHTML = '<div class="result-message fail">‚ùå Incorrecto. ¬°Sigue estudiando!</div>';
            }
            
            modalActions.innerHTML = '<button class="close-btn" onclick="closeModal()">Cerrar</button>';
        }

        // Mostrar castigo
        function showCastigo(segment) {
            modalBody.textContent = `‚ö†Ô∏è ${segment.action}`;
            modalActions.innerHTML = '<button class="close-btn" onclick="closeModal()">¬°Hecho!</button>';
        }

        // Mostrar frase
        function showFrase(segment) {
            modalBody.textContent = segment.message;
            modalActions.innerHTML = '<button class="close-btn" onclick="closeModal()">Cerrar</button>';
        }

        // Mostrar premio
        function showPremio(segment) {
            playWinSound();
            createConfetti();
            modalBody.innerHTML = `<div class="result-message success">${segment.message}</div>`;
            modalActions.innerHTML = '<button class="close-btn" onclick="closeModal()">¬°Gracias!</button>';
        }

        // Cerrar modal
        function closeModal() {
            modal.classList.remove('active');
            modalBody.innerHTML = '';
            modalActions.innerHTML = '';
        }

        // Inicializar
        window.addEventListener('load', setupCanvas);
        window.addEventListener('resize', setupCanvas);
        spinButton.addEventListener('click', spinWheel);
    </script>
</body>
</html>